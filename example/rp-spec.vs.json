{
  "/": {
    "matches": {
      "specification": "non_empty_list",
      "subresource_path": "non_empty_dict",
      "excluded_tests": "non_empty_list"
    },

    "/specification": {
      "/*": {
        "matches": {
          "name": "non_empty_string",
          "title": "non_empty_string",
          "description": "non_empty_string",
          "referrer_policy": "@referrer_policy_schema",
          "specification_url": "non_empty_string",
          "test_expansion": "non_empty_list"
        },

        "/test_expansion": {
          "/*": {
            "path": "gen/%(_name)s/%(delivery_method)s/%(origin)s/%(source_protocol)s-%(target_protocol)s/%(subresource)s/%(name)s.%(redirection)s.%(source_protocol)s.html",
            "template": "The referrer URL is %(referrer_url)s when a document served over %(source_protocol)s requires an %(target_protocol)s sub-resource via %(subresource)s using the %(delivery_method)s delivery method with %(redirection)s and when the target request is %(origin)s.",
            "matches": "@test_expansion_schema"
          }
        }
      }
    },

    "/excluded_tests": {
      "/*": {
        "matches": "@test_expansion_schema"
      }
    },

    "/subresource_path":  {
      "has_keys": "@test_expansion_schema/subresource",
      "each_value": "existing_file"
    }
  },

  "#referrer_policy_schema": [
    null,
    "no-referrer",
    "no-referrer-when-downgrade",
    "origin",
    "origin-when-crossorigin",
    "unsafe-url"
  ],

  "#test_expansion_schema": {
    "name": "non_empty_string",

    "expansion": [
      "default",
      "override"
    ],

    "delivery_method": [
      "http-csp",
      "meta-referrer",
      "meta-csp",
      "attr-referrer",
      "rel-noreferrer"
    ],

    "origin": [
      "same-origin",
      "cross-origin"
    ],

    "source_protocol": [
      "http",
      "https"
    ],

    "target_protocol": [
      "http",
      "https"
    ],

    "redirection": [
      "no-redirect",
      "keep-origin-redirect",
      "swap-origin-redirect"
    ],

    "subresource": [
      "iframe-tag",
      "img-tag",
      "script-tag",
      "a-tag",
      "area-tag",
      "xhr-request",
      "worker-request",
      "fetch-request"
    ],

    "referrer_url": [
      "omitted",
      "origin",
      "stripped-referrer"
    ]
  }
}
